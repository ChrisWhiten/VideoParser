<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en"><head>


<meta name="GENERATOR" content="PPWIZARD version 05.013 on WINXP, FREE 
tool for Windows, OS/2, DOS and UNIX by Dennis Bareis 
(http://dennisbareis.id.au/ppwizard.htm)">

<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="author" content="CompuPhase">
<link rel="top" href="http://www.compuphase.com/index_en.htm" 
title="Homepage">
<link rel="up" href="http://www.compuphase.com/index_en.htm" title="Up">
<link rel="toc" href="http://www.compuphase.com/index_en.htm" 
title="Table of contents">
<link rel="stylesheet" type="text/css" 
href="color_metric_files/cphase-screen.css" media="screen" 
title="CompuPhase (screen)">
<link rel="stylesheet" type="text/css" 
href="color_metric_files/cphase-print.css" media="print,braille">
<!--[if IE 7]><link rel="stylesheet" type="text/css" href="./cphase-screen-ie7.css" media="screen" /><![endif]-->
<title>Colour metric</title>
<style type="text/css">#jsMath_test {font-size:200%}
</style><style type="text/css">.math {font-family: serif; font-style: normal; font-weight: normal}
.typeset {font-family: serif; font-style: normal; font-weight: normal; line-height: normal; text-indent: 0px}
.typeset .normal {font-family: serif; font-style: normal; font-weight: normal}
div.typeset {text-align: center; margin: 1em 0px}
span.typeset {text-align: left}
.typeset span {text-align: left; border: 0px; margin: 0px; padding: 0px}
a .typeset img, .typeset a img {border: 0px; border-bottom: 1px solid blue;}
.typeset .size0 {font-size: 50%}
.typeset .size1 {font-size: 60%}
.typeset .size2 {font-size: 70%}
.typeset .size3 {font-size: 85%}
.typeset .size4 {font-size: 100%}
.typeset .size5 {font-size: 120%}
.typeset .size6 {font-size: 144%}
.typeset .size7 {font-size: 173%}
.typeset .size8 {font-size: 207%}
.typeset .size9 {font-size: 249%}
.typeset .cmr10 {font-family: jsMath-cmr10, serif}
.typeset .cmbx10 {font-family: jsMath-cmbx10, jsMath-cmr10}
.typeset .cmti10 {font-family: jsMath-cmti10, jsMath-cmr10}
.typeset .cmmi10 {font-family: jsMath-cmmi10}
.typeset .cmsy10 {font-family: jsMath-cmsy10}
.typeset .cmex10 {font-family: jsMath-cmex10}
.typeset .textit {font-family: serif; font-style: italic}
.typeset .textbf {font-family: serif; font-weight: bold}
.typeset .link {text-decoration: none}
.typeset .error {font-size: 90%; font-style: italic; background-color: #FFFFCC; padding: 1px; border: 1px solid #CC0000}
.typeset .blank {display: -moz-inline-box; overflow: hidden; border: 0px none; width: 0px; height: 0px}
.typeset .spacer {}
#jsMath_hiddenSpan {visibility: hidden; position: absolute; top: 0px; left: 0px; line-height: normal; text-indent: 0px}
#jsMath_message {position: fixed; bottom: 1px; left: 2px; background-color: #E6E6E6; border: solid 1px #959595; margin: 0px; padding: 1px 8px; z-index: 102; color: black; font-size: small; width: auto}
#jsMath_panel {position: fixed; bottom: 1.75em; right: 1.5em; padding: .8em 1.6em; background-color: #DDDDDD; border: outset 2px; z-index: 103; width: auto; color: black; font-size: 10pt; font-style: normal}
#jsMath_panel .disabled {color: #888888}
#jsMath_panel .infoLink {font-size: 85%}
#jsMath_panel * {font-size: inherit; font-style: inherit; font-family: inherit; line-height: normal}
#jsMath_panel div {background-color: inherit; color: inherit}
#jsMath_panel span {background-color: inherit; color: inherit}
#jsMath_panel td {border: 0px; padding: 0px; margin: 0px; background-color: inherit; color: inherit}
#jsMath_panel tr {border: 0px; padding: 0px; margin: 0px; background-color: inherit; color: inherit}
#jsMath_panel table {border: 0px; padding: 0px; margin: 0px; background-color: inherit; color: inherit; height: auto; width: auto}
#jsMath_button {position: fixed; bottom: 1px; right: 2px; background-color: white; border: solid 1px #959595; margin: 0px; padding: 0px 3px 1px 3px; z-index: 102; color: black; text-decoration: none; font-size: x-small; width: auto; cursor: pointer}
#jsMath_button * {padding: 0px; border: 0px; margin: 0px; line-height: normal; font-size: inherit; font-style: inherit; font-family: inherit}
#jsMath_global {font-style: italic}
#jsMath_noFont .message {text-align: center; padding: .8em 1.6em; border: 3px solid #DD0000; background-color: #FFF8F8; color: #AA0000; font-size: small; width: auto}
#jsMath_noFont .link {padding: 0px 5px 2px 5px; border: 2px outset; background-color: #E8E8E8; color: black; font-size: 80%; width: auto; cursor: pointer}
#jsMath_PrintWarning .message {text-align: center; padding: .8em 1.6em; border: 3px solid #DD0000; background-color: #FFF8F8; color: #AA0000; font-size: x-small; width: auto}
@media print {#jsMath_button {display: none}
#jsMath_Warning {display: none}
}
@media screen {#jsMath_PrintWarning {display: none}
}
.typeset .scale {font-size: 100%}
</style><style type="text/css">.typeset .math {font-style: normal}
.typeset .typeset {font-style: normal}
.typeset .icmr10 {font-family: serif}
.typeset .icmmi10 {font-family: serif; font-style: italic}
.typeset .icmbx10 {font-family: serif; font-weight: bold}
.typeset .icmti10 {font-family: serif; font-style: italic}
</style></head><body><div title="" style="visibility: hidden;" 
id="jsMath_message"></div><div id="jsMath_PrintWarning"><center><table><tbody><tr><td><div
 class="message">To print higher-resolution math symbols, click the<br>
<b>Hi-Res Fonts for Printing</b> button on the jsMath control panel.<br>
If the math symbols print as black boxes, turn off <b>image alpha 
channels</b><br>
using the <b>Options</b> pane of the jsMath control panel.<br>
</div><div style="width: 22em; height: 1px;"></div></td></tr></tbody></table></center><hr></div><div
 id="jsMath_Warning"><center><table><tbody><tr><td><div 
id="jsMath_noFont"><div class="message"><b>No jsMath TeX fonts found</b>
 -- using image fonts instead.<br>
These may be slow and might not print well.<br>
Use the jsMath control panel to get additional information.<div 
style="text-align: left;"><span style="float: left; margin: 8px 0px 0px 
20px;"><span onclick="jsMath.Controls.Panel()" title=" Open the jsMath 
Control Panel " class="link">jsMath Control Panel</span></span><span 
style="margin: 8px 20px 0px 0px; float: right;"><span 
onclick="jsMath.Font.HideMessage()" title=" Remove this font warning 
message " class="link">Hide this Message</span></span></div><div 
style="height: 6px;"></div><br clear="all"></div></div><div 
style="width: 22em; height: 1px;"></div></td></tr></tbody></table></center><hr></div><div
 title=" Open jsMath Control Panel " id="jsMath_button"><span 
onclick="jsMath.Controls.Panel()">jsMath</span></div><div 
style="display: none;" id="jsMath_panel"></div><div style="visibility: 
hidden; position: absolute; top: 0pt; left: 0pt; border: 0pt none; 
padding: 0pt; margin: 0pt;" id="jsMath_Hidden"></div>
<div id="top"><a href="#main-copy" class="doNotDisplay doNotPrint">Skip 
to main content.</a></div>
<div id="header">
<div class="superHeader">
<div class="left">
You are here:
<a href="http://www.compuphase.com/index_en.htm">Home</a> &gt;
<a href="http://www.compuphase.com/articles_en.htm">Articles</a> &gt;
<a href="http://www.compuphase.com/articles_cg_en.htm">Computer graphics</a>
 &gt;
Colour metric
</div>
<div class="right">
<span class="doNotDisplay doNotPrint">Current language:</span>
<acronym title="This page is in the English language. See the main menu 
('Home') for language selection.">
<img src="color_metric_files/flag_en.gif" alt="This page is in the 
English language. See the main menu ('Home') for language selection." 
height="22" width="43">
</acronym>
</div>
</div>
<div class="midHeader">
<div class="right">
<form action="/cgi-bin/htsearch" method="post" style="margin: 0pt;"><p>
<input name="method" value="and" type="hidden">
<input name="format" value="builtin-long" type="hidden">
<input name="sort" value="score" type="hidden">
<input name="config" value="com783" type="hidden">
<input name="restrict" value="" type="hidden">
<input name="exclude" value="" type="hidden">
<input name="words" id="words" size="18" class="textbox" alt="Word(s) to
 search" accesskey="S" type="text">
<input name="submit" class="submit" value="search" type="submit">
<br><a href="http://www.compuphase.com/htdig/common/search.html">help / 
extended search</a>
</p></form>
</div>
<div class="left">
<img src="color_metric_files/cplogo-lp-180.gif" alt="CompuPhase" 
align="left" height="38" width="180">
</div>
</div>
<div class="subHeader">
<span class="doNotDisplay doNotPrint"><br>Navigation:</span>
<ul class="navigation">
<li>
<a href="http://www.compuphase.com/index_en.htm" class="tab">Home</a>
</li>
<li>
<a href="http://www.compuphase.com/projects_en.htm" class="tab">Projects</a>
</li>
<li>
<a href="http://www.compuphase.com/products_en.htm" class="tab">Products</a>
</li>
<li>
<span class="highlighted tab">Articles</span>
</li>
</ul>
</div>
</div>
<div class="letterHead">
<div class="right">
IBAN: NL79 ABNA 0477 3565 08<br>
BIC / SWIFT: ABNANL2A<br>
EU-VAT: NL170160656B01<br>
Chamber of Commerce: 32041148
</div>
<div class="left">
Eerste Industriestraat 19-21<br>
1401VL &nbsp; Bussum &nbsp; Netherlands<br>
tel. +31 35 693 9261<br>
info@compuphase.com
</div>
<img src="color_metric_files/cplogo-lp-300.png" alt="CompuPhase">
<hr>
</div>
<div id="side-bar">
<div>
<p class="sideBarTitle">Articles</p>
<table class="sideBarTable" summary="side menu" width="100%">
<tbody><tr><td class="sideBarCell">
<img src="color_metric_files/icon_s_papers.gif" alt="icon for articles" 
height="16" width="16">
</td><td>
<a href="http://www.compuphase.com/articles_en.htm" title="Introduction 
to the articles">Introduction</a>
</td></tr><tr><td class="sideBarCell">
<img src="color_metric_files/icon_s_papers.gif" alt="icon for articles" 
height="16" width="16">
</td><td>
<a href="http://www.compuphase.com/articles_pub_en.htm" title="A list of
 magazine articles by authors of CompuPhase">Published articles</a>
</td></tr><tr><td class="sideBarCell">
<img src="color_metric_files/icon_s_papers.gif" alt="icon for articles" 
height="16" width="16">
</td><td>
<a href="http://www.compuphase.com/articles_appnotes_en.htm" 
title="CompuPhase product application notes">Application notes</a>
</td></tr><tr><td class="sideBarCell">
<img src="color_metric_files/icon_s_papers.gif" alt="icon for articles" 
height="15" width="15">
</td><td>
<a href="http://www.compuphase.com/articles_windows_en.htm" 
title="Technical articles related to programming for Microsoft Windows">Microsoft
 Windows - technical articles</a>
</td></tr><tr><td class="sideBarCell">
<img src="color_metric_files/icon_s_papers.gif" alt="icon for articles" 
height="16" width="16">
</td><td>
<a href="http://www.compuphase.com/articles_embedded_en.htm" 
title="Embedded system programming">Embedded systems</a>
</td></tr><tr><td class="sideBarCell">
<img src="color_metric_files/icon_s_papers.gif" alt="icon for articles" 
height="16" width="16">
</td><td>
<a href="http://www.compuphase.com/articles_electronics_en.htm" 
title="Electronic circuits and background information">Electronics</a>
</td></tr><tr><td class="sideBarCell">
<img src="color_metric_files/icon_s_papers.gif" alt="icon for articles" 
height="16" width="16">
</td><td>
<a href="http://www.compuphase.com/articles_cg_en.htm" title="Technical 
articles related to programming computer graphics applications">Computer
 graphics</a>
</td></tr><tr><td class="sideBarCell">
<img src="color_metric_files/icon_s_papers.gif" alt="icon for articles" 
height="16" width="16">
</td><td>
<a href="http://www.compuphase.com/articles_anim_en.htm" 
title="Introductory or technical articles related to computer animation">Computer
 animation</a>
</td></tr><tr><td class="sideBarCell">
<img src="color_metric_files/icon_s_papers.gif" alt="icon for articles" 
height="16" width="16">
</td><td>
<a href="http://www.compuphase.com/articles_filefmt_en.htm" 
title="Descriptions and comments on (mostly graphical) file formats">File
 formats</a>
</td></tr><tr><td class="sideBarCell">
<img src="color_metric_files/icon_s_papers.gif" alt="icon for articles" 
height="16" width="16">
</td><td>
<a href="http://www.compuphase.com/articles_misc_en.htm" 
title="Miscellaneous online articles">Miscellaneous articles</a>
</td></tr>
</tbody></table>
</div>
<div class="lighterBackground">
<p class="sideBarTitle">Copyright</p>
<span class="sideBarText">
All papers and articles on this site are copyrighted work.
This work is licensed under a &nbsp; <br> <a rel="license" 
href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons 
License</a> &nbsp;<br>
<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"><img
 alt="Creative Commons License" 
src="color_metric_files/somerights20.png" align="center" border="0"></a>
</span>
</div>
</div>
<div id="main-copy">
<style> #jsMath_Warning {display: none} </style>
<script src="color_metric_files/jsMath.js"></script>
<div id="jsMath_myMessage"><center><table><tbody><tr><td><div 
id="jsMath_noFont"><div class="message"><b>No jsMath TeX fonts found</b>
 -- using image fonts instead.<br>
These may be slow and might not print well.<br>
Use the jsMath control panel to get additional information.<div 
style="text-align: left;"><span style="float: left; margin: 8px 0px 0px 
20px;"><span onclick="jsMath.Controls.Panel()" title=" Open the jsMath 
Control Panel " class="link">jsMath Control Panel</span></span><span 
style="margin: 8px 20px 0px 0px; float: right;"><span 
onclick="jsMath.Font.HideMessage()" title=" Remove this font warning 
message " class="link">Hide this Message</span></span></div><div 
style="height: 6px;"></div><br clear="all"></div></div><div 
style="width: 22em; height: 1px;"></div></td></tr></tbody></table></center><hr></div>
<script>
jsMath.Synchronize(function () {
var message = jsMath.Element("Warning");
if (message) {
jsMath.Element("myMessage").innerHTML = message.innerHTML;
}
});
</script>
<noscript>
<blockquote class="warningNote">
This page requires JavaScript to process the mathematics on this page.<br/>
If your browser supports JavaScript, please make sure that it is enabled.
</blockquote>
</noscript>
<h1>Colour metric</h1><div class="header1Bar">&nbsp;</div>
<blockquote class="sideNote">
<h3>A personal note</h3>
<p>Colour perception is a difficult and little understood problem, which
 seems
to defy even the most ingenious mathematical expressions. When 
researching
the implementation of colour quantization algorithms, I stumbled more 
than
once on theoretical discussions that were difficult to follow, and 
sometimes
nearly impossible to verify (or to reject, for that matter). I am an 
engineer,
not a scientist, and the adage for engineers is "through measurement to 
knowledge".
</p><p>The conclusions drawn in this paper are based on simple tests 
with real
people. Somewhere in the paper I state that evaluating colour 
differences
is subjective: when asked to pick the "closest" match for a specific 
colour
from a small palette, the selections by the test persons differ. On the 
one
hand, you may claim that the test setup must have been flawed. A good 
test
should rule out subjectivity. On the other hand, you should also 
recognize
that about one out of eight men is more or less colour-blind. As it
turned out, individuals with a (slight) green-red deficiency were 
amongst my
test persons, and their results count as much as everyone else's.
</p><p>Once, I asked on UseNet about the "equivalent gray level" of a 
colour. The
replies were "30% red + 59% green + 11% blue", without exception, and 
without
hesitation or a critical note. I started a simple paint program and drew
 two
rectangles: a blue one with RGB values (0,&nbsp;0,&nbsp;255) and a green
 one
with RGB values (0,&nbsp;48,&nbsp;0). According to the formula, that 
everyone
that was kind enough to respond to me had given, these rectangles
<em>should</em> have the same brightness, but they clearly had not.
<a href="#FOLEY">Foley [<i>et al.</i>]</a> implies (p. 589) that the 
equation applies to
<em>linear</em> RGB, which is contradicted in <a href="#POYNTON2">Poynton's
 "colorspace-faq"</a>.
After gamma correction (the green cube gets RGB (0,&nbsp;131,&nbsp;0), 
blue
cube stays at RGB (0,&nbsp;0,&nbsp;255), for a gamma of 2.5), the result
 was
still debatable. I wondered whether anyone had done the same, simple,
10-second test before asserting the 30%-59%-11% rule. For me, this rule 
is how
NTSC encodes luma/chroma channels, not how the human eye perceives 
brightness.
I have difficulty to believe that the weighting was correct for the 
phosphors
that were used at the time that NTSC was carved in stone, because the 
phosphors
used in contemporary computer monitors have not changed <em>that</em> 
much from
those used in the early days.
</p><p>I concluded a paper on the <a 
href="http://www.compuphase.com/palette.htm">Microsoft Windows Palette
Manager</a> by insisting that you should experiment and verify your
assumptions. I would like to conclude this note in the same spirit: do 
not
take my word for granted, nor that of anyone else. Experiment! Compare!
Actions speak louder than words; and remember:
</p><div align="center"><strong>Through measurement to knowledge</strong><br><small>(H.
 Kamerlingh Onnes, 1882)</small></div>
</blockquote>
<h2>Motivation</h2>
<ul>
<li>When you map a true colour (photographic) image to a reduced palette
 (say,
256 colours), every true-colour pixel must be mapped to the palette 
entry that
comes closest to original colour.
</li><li>Vector Quantization is a lossy compression technique that, when
 applied to
images, quantizes multiple pixels at a time. It is thereby an extension 
of the
straight colour quantization (or palette mapping) described in the 
previous
point, and it has the same quality criterions.
</li><li>Other lossy image compression techniques use a "quality 
criterion" -- the
difference between the original colour and the quantized colour should 
remain
below some threshold. This requires that you can determine the 
difference
between pictures, starting with the difference between pixels.
</li></ul>
<p>Thus the questions "what is the closest colour?" and "how
does one measure the distance between colours?" become relevant.
</p><p>This paper evaluates several common metrics of colour distance 
and
presents new formula that is both simple and produces good results.
</p><h2>Overview</h2>
<p>If we can map a colour in some multi-dimensional (abstract) space, 
the
distance between two colours is <span class="typeset"><nobr><span 
class="scale"><span style="position: relative; top: 0.025em;"><img 
src="color_metric_files/char6B.png" style="height: 15px; width: 6px; 
vertical-align: -4px; margin-right: 0.068em;"></span><span 
class="icmmi10">c</span><span style="position: relative; top: 0.286em;"><span
 class="size2"><span class="icmr10">1</span></span><span class="spacer" 
style="margin-left: 0.05em;"></span></span><span style="position: 
relative; margin-left: 0.222em;"><span class="icmsy10">−</span></span><span
 style="position: relative; margin-left: 0.222em;"><span class="icmmi10">c</span><span
 style="position: relative; top: 0.286em;"><span class="size2"><span 
class="icmr10">2</span></span><span class="spacer" style="margin-left: 
0.05em;"></span></span></span><span style="position: relative; top: 
0.025em;"><img src="color_metric_files/char6B.png" style="height: 15px; 
width: 6px; vertical-align: -4px; margin-right: 0.068em;"></span></span></nobr></span>,
where <span class="typeset"><nobr><span class="scale"><span 
style="position: relative; top: 0.025em;"><img 
src="color_metric_files/char6B.png" style="height: 15px; width: 6px; 
vertical-align: -4px; margin-right: 0.068em;"></span><img 
src="color_metric_files/char03.png" style="height: 7px; width: 7px;"><span
 style="position: relative; top: 0.025em;"><img 
src="color_metric_files/char6B.png" style="height: 15px; width: 6px; 
vertical-align: -4px; margin-right: 0.068em;"></span></span></nobr></span>
 denotes the Euclidean
distance. For a three-dimensional space (with dimensions <i>x</i>, <i>y</i>
and <i>z</i>) the Euclidean distance is calculated as follows:
</p><div class="typeset"><nobr><span class="scale"><span 
style="position: relative;"><span style="position: absolute; top: 0em; 
left: 0em;"><span style="position: relative; top: 0.025em;"><img 
src="color_metric_files/char6B.png" style="height: 15px; width: 6px; 
vertical-align: -4px; margin-right: 0.068em;"></span><span 
class="icmmi10">c</span><span style="position: relative; top: 0.286em;"><span
 class="size2"><span class="icmr10">1</span></span><span class="spacer" 
style="margin-left: 0.05em;"></span></span><span style="position: 
relative; margin-left: 0.222em;"><span class="icmsy10">−</span></span><span
 style="position: relative; margin-left: 0.222em;"><span class="icmmi10">c</span><span
 style="position: relative; top: 0.286em;"><span class="size2"><span 
class="icmr10">2</span></span><span class="spacer" style="margin-left: 
0.05em;"></span></span></span><span style="position: relative; top: 
0.025em;"><img src="color_metric_files/char6B.png" style="height: 15px; 
width: 6px; vertical-align: -4px; margin-right: 0.068em;"></span><span 
style="position: relative; margin-left: 0.277em;"><span class="icmr10">=</span></span><span
 style="position: relative; margin-left: 0.277em;"><span 
style="position: relative; top: -1.183em;"><span style="position: 
relative; top: 0.05em;"><img src="color_metric_files/char71.png" 
style="height: 26px; width: 15px; vertical-align: -25px; margin-right: 
-0.079em;"></span></span><span style="position: relative; top: 
-1.153em;"><span class="blank" style="border-left: 16.306em solid; 
height: 1.5px; vertical-align: 0.112em;"></span></span><span 
style="position: relative; margin-left: -16.306em;"><span class="icmr10">(</span><span
 class="icmmi10">c</span><span style="position: relative; top: 0.286em;"><span
 class="size2"><span class="icmr10">1</span><img 
src="color_metric_files/char3B.png" style="height: 4px; width: 3px; 
vertical-align: -2px; margin-right: -0.031em;"><span class="icmmi10">x</span></span><span
 class="spacer" style="margin-left: 0.05em;"></span></span><span 
style="position: relative; margin-left: 0.222em;"><span class="icmsy10">−</span></span><span
 style="position: relative; margin-left: 0.222em;"><span class="icmmi10">c</span><span
 style="position: relative; top: 0.286em;"><span class="size2"><span 
class="icmr10">2</span><img src="color_metric_files/char3B.png" 
style="height: 4px; width: 3px; vertical-align: -2px; margin-right: 
-0.031em;"><span class="icmmi10">x</span></span><span class="spacer" 
style="margin-left: 0.05em;"></span></span></span><span class="icmr10">)</span><span
 style="position: relative; top: -0.288em;"><span class="size2"><span 
class="icmr10">2</span></span><span class="spacer" style="margin-left: 
0.05em;"></span></span><span style="position: relative; margin-left: 
0.222em;"><span class="icmr10">+</span></span><span style="position: 
relative; margin-left: 0.222em;"><span class="icmr10">(</span></span><span
 class="icmmi10">c</span><span style="position: relative; top: 0.286em;"><span
 class="size2"><span class="icmr10">1</span><img 
src="color_metric_files/char3B.png" style="height: 4px; width: 3px; 
vertical-align: -2px; margin-right: -0.031em;"></span><span 
class="size2"><span class="icmmi10">y</span></span><span class="spacer" 
style="margin-left: 0.025em;"></span><span class="spacer" 
style="margin-left: 0.05em;"></span></span><span style="position: 
relative; margin-left: 0.222em;"><span class="icmsy10">−</span></span><span
 style="position: relative; margin-left: 0.222em;"><span class="icmmi10">c</span><span
 style="position: relative; top: 0.286em;"><span class="size2"><span 
class="icmr10">2</span><img src="color_metric_files/char3B.png" 
style="height: 4px; width: 3px; vertical-align: -2px; margin-right: 
-0.031em;"></span><span class="size2"><span class="icmmi10">y</span></span><span
 class="spacer" style="margin-left: 0.025em;"></span><span 
class="spacer" style="margin-left: 0.05em;"></span></span></span><span 
class="icmr10">)</span><span style="position: relative; top: -0.288em;"><span
 class="size2"><span class="icmr10">2</span></span><span class="spacer" 
style="margin-left: 0.05em;"></span></span><span style="position: 
relative; margin-left: 0.222em;"><span class="icmr10">+</span></span><span
 style="position: relative; margin-left: 0.222em;"><span class="icmr10">(</span></span><span
 class="icmmi10">c</span><span style="position: relative; top: 0.286em;"><span
 class="size2"><span class="icmr10">1</span><img 
src="color_metric_files/char3B.png" style="height: 4px; width: 3px; 
vertical-align: -2px; margin-right: -0.031em;"></span><span 
class="size2"><span class="icmmi10">z</span></span><span class="spacer" 
style="margin-left: 0.03em;"></span><span class="spacer" 
style="margin-left: 0.05em;"></span></span><span style="position: 
relative; margin-left: 0.222em;"><span class="icmsy10">−</span></span><span
 style="position: relative; margin-left: 0.222em;"><span class="icmmi10">c</span><span
 style="position: relative; top: 0.286em;"><span class="size2"><span 
class="icmr10">2</span><img src="color_metric_files/char3B.png" 
style="height: 4px; width: 3px; vertical-align: -2px; margin-right: 
-0.031em;"></span><span class="size2"><span class="icmmi10">z</span></span><span
 class="spacer" style="margin-left: 0.03em;"></span><span class="spacer"
 style="margin-left: 0.05em;"></span></span></span><span class="icmr10">)</span><span
 style="position: relative; top: -0.288em;"><span class="size2"><span 
class="icmr10">2</span></span><span class="spacer" style="margin-left: 
0.05em;"></span></span></span></span>&nbsp;</span><span class="blank" 
style="width: 22.167em; height: 1.052em; vertical-align: 1.052em;"></span></span><span
 class="blank" style="height: 2.03em; vertical-align: 1.353em;"></span></span></nobr></div>
<p>Graphic applications for the PC usually employ the
<i>Red</i>-<i>Green</i>-<i>Blue</i> (RGB) colour space. This model maps 
well
to the way the common <i>Cathode Ray Tube</i> (CRT) display works. These
displays have three kinds of phosphors that emit red, green or blue 
light when
they are struck by an electron beam. Another advantage of the RGB model 
is
that it is a three-dimensional orthogonal space, precisely what we need 
for
the Euclidean distance function.
</p><p>The problem with RGB is that it is not always the easiest model 
to use
(that is why printers usually use the CMYK model), and more 
fundamentally, it
does not model the way in which we (humans) perceive colour.
</p><p>The standard colour model is CIE XYZ colour space.  All other 
models can be
interpreted as different mappings or subsets of the CIE XYZ colour 
space. CIE
is a complex model and, most of all, although it defines the space
of all colours that we can distinguish, it does <em>not</em> provide a
<em>perceptually uniform</em> colour space. Thus, the distance between
two points in the CIE XYZ space has no relation to the relative 
closeness of
these colours.  After ten years of debate, the CIE could not reach 
agreement
on a definition of a perceptual uniform colour space, and therefore 
applied its
stamp of approval on <em>two</em> competing perceptual uniform colour 
models:
CIE L<sup>*</sup>a<sup>*</sup>b<sup>*</sup> and
CIE L<sup>*</sup>u<sup>*</sup>v<sup>*</sup> --but they, too, are 
regarded
today as inadequate models for the perception of colour
[<a href="#GRANGER">Granger, 1994</a>]. The CIE has more or less
acknowledged this itself by taking a proposed modification by D. Alman 
into
recommendation [<a href="#ALMAN">Alman, 1993</a>]. A specific flaw that 
several
studies have identified is that CIE L<sup>*</sup>a<sup>*</sup>b<sup>*</sup>
progressively overemphasizes colour differences as the chroma of the 
colours
increases.
</p><p>Both [<a href="#FOLEY">Foley, 1990</a>] and [<a href="#POYNTON2">Poynton,
 1999</a>]
give formulae to convert from RGB to CIE XYZ and from there to
CIE L<sup>*</sup>u<sup>*</sup>v<sup>*</sup>. Alman's modification is a 
bit
harder to come by, unless you can find the magazine. However, there is 
an easy
improvement of CIE L<sup>*</sup>u<sup>*</sup>v<sup>*</sup>, and one that
 has
been suggested by several independent sources ([<a href="#GRANGER">Granger,
 1994</a>],
[<a href="#NEMCSICS">Nemcsics, 1993</a>]) is that the brightness L<sup>*</sup>
 is proportional
to <span class="typeset"><nobr><span class="scale"><span 
style="position: relative;"><span style="position: absolute; top: 0em; 
left: 0em;"><span style="position: relative; top: -0.919em;"><span 
style="position: relative; top: 0.05em;"><img 
src="color_metric_files/char70_002.png" style="height: 15px; width: 
12px; vertical-align: -14px; margin-right: -0.03em;"></span></span><span
 style="position: relative; top: -0.889em;"><span class="blank" 
style="border-left: 0.526em solid; height: 1.5px; vertical-align: 
0.112em;"></span></span><span style="position: relative; margin-left: 
-0.526em;"><span class="icmmi10">Y</span></span>&nbsp;</span><span 
class="blank" style="width: 1.427em; height: 1.052em; vertical-align: 
1.052em;"></span></span><span class="blank" style="height: 1.23em; 
vertical-align: 1.089em;"></span></span></nobr></span> rather than to <span
 class="typeset"><nobr><span class="scale"><span style="position: 
relative;"><span style="position: absolute; top: 0em; left: 0em;"><span 
style="position: relative; top: -0.919em;"><span style="position: 
relative; top: 0.05em;"><img src="color_metric_files/char70_002.png" 
style="height: 15px; width: 12px; vertical-align: -14px; margin-right: 
-0.03em;"></span></span><span style="position: relative; margin-left: 
-0.624em; top: -0.604em;"><span class="size0"><span class="icmr10">3</span></span></span><span
 style="position: relative; margin-left: 0.323em; top: -0.889em;"><span 
class="blank" style="border-left: 0.526em solid; height: 1.5px; 
vertical-align: 0.112em;"></span></span><span style="position: relative;
 margin-left: -0.526em;"><span class="icmmi10">Y</span></span>&nbsp;</span><span
 class="blank" style="width: 1.427em; height: 1.052em; vertical-align: 
1.052em;"></span></span><span class="blank" style="height: 1.23em; 
vertical-align: 1.089em;"></span></span></nobr></span>
(square root instead of cube root).
According to reports, Nemcsics came to this conclusion after experiments
 with
2500 observers in a "complex environment" --an environment where the 
eyes of
the observers are not fully adapted to the luminance level.
</p><p>The video and television industry researched the issue of 
perceptually
uniform colour models, to achieve high quality compression. Video 
channels
have limited bandwidth; compactly coding the luminance and chrominance
information is a requirement. But when you decide to throw some of the 
data
away, you will wish to do so while retaining the best visual quality. 
Two
well-known models that the video industry developed are "YIQ" and "YUV".
 YUV
is used by the Betamax standard and PAL and SECAM (European television),
 as
well as by a few computer graphic formats. NTSC (American television) 
uses YIQ;
basically, YIQ is YUV with scaling factors optimized for a reduced 
bandwidth.
For completeness, below are the matrices for transforming from gamma 
corrected
R'G'B' to YUV and YIQ:
</p><div class="typeset"><nobr><span class="scale"><span 
style="position: relative;"><span style="position: absolute; top: 
-2.26em; left: 0em;"><span style="position: absolute; left: 0em; top: 
0em;"><img src="color_metric_files/char32.png" style="height: 26px; 
width: 10px; vertical-align: -25px; margin-right: -0.052em;">&nbsp;</span><span
 style="position: absolute; left: 0em; top: 1.71em;"><img 
src="color_metric_files/char36.png" style="height: 10px; width: 6px; 
vertical-align: -9px; margin-right: 0.235em;">&nbsp;</span><span 
style="position: absolute; left: 0em; top: 2.3em;"><img 
src="color_metric_files/char34.png" style="height: 26px; width: 10px; 
vertical-align: -25px; margin-right: -0.052em;">&nbsp;</span>&nbsp;</span><span
 class="blank" style="width: 0.676em; height: 1.052em; vertical-align: 
1.052em;"></span></span><span style="position: relative;"><span 
style="position: absolute; top: 0em; left: 0em;"><span class="spacer" 
style="margin-left: 0.166em;"></span><span style="position: absolute; 
left: 0.204em; top: -1.393em;"><span class="icmmi10">Y</span><span 
class="spacer" style="margin-left: 0.222em;"></span>&nbsp;</span><span 
style="position: absolute; left: 0.204em; top: 0.125em;"><span 
class="icmmi10">U</span><span class="spacer" style="margin-left: 
0.109em;"></span>&nbsp;</span><span style="position: absolute; left: 
0.166em; top: 1.644em;"><span class="icmmi10">V</span><span 
class="spacer" style="margin-left: 0.222em;"></span>&nbsp;</span><span 
class="spacer" style="margin-left: 0.166em;"></span>&nbsp;</span><span 
class="blank" style="width: 1.159em; height: 4.391em; vertical-align: 
2.445em;"></span></span><span style="position: relative;"><span 
style="position: absolute; top: -2.26em; left: 0em;"><span 
style="position: absolute; left: 0em; top: 0em;"><img 
src="color_metric_files/char33.png" style="height: 26px; width: 5px; 
vertical-align: -25px; margin-right: 0.307em;">&nbsp;</span><span 
style="position: absolute; left: 0em; top: 1.71em;"><img 
src="color_metric_files/char37.png" style="height: 10px; width: 5px; 
vertical-align: -9px; margin-right: 0.307em;">&nbsp;</span><span 
style="position: absolute; left: 0em; top: 2.3em;"><img 
src="color_metric_files/char35.png" style="height: 26px; width: 5px; 
vertical-align: -25px; margin-right: 0.307em;">&nbsp;</span>&nbsp;</span><span
 class="blank" style="width: 0.676em; height: 1.052em; vertical-align: 
1.052em;"></span></span><span style="position: relative; margin-left: 
0.277em;"><span class="icmr10">=</span></span><span style="position: 
relative; margin-left: 0.277em;"><span style="position: relative;"><span
 style="position: absolute; top: -2.26em; left: 0em;"><span 
style="position: absolute; left: 0em; top: 0em;"><img 
src="color_metric_files/char32.png" style="height: 26px; width: 10px; 
vertical-align: -25px; margin-right: -0.052em;">&nbsp;</span><span 
style="position: absolute; left: 0em; top: 1.71em;"><img 
src="color_metric_files/char36.png" style="height: 10px; width: 6px; 
vertical-align: -9px; margin-right: 0.235em;">&nbsp;</span><span 
style="position: absolute; left: 0em; top: 2.3em;"><img 
src="color_metric_files/char34.png" style="height: 26px; width: 10px; 
vertical-align: -25px; margin-right: -0.052em;">&nbsp;</span>&nbsp;</span><span
 class="blank" style="width: 0.676em; height: 1.052em; vertical-align: 
1.052em;"></span></span><span style="position: relative;"><span 
style="position: absolute; top: 0em; left: 0em;"><span class="spacer" 
style="margin-left: 0.166em;"></span><span style="position: absolute; 
left: 0.429em; top: -1.393em;"><span class="icmr10">0</span><img 
src="color_metric_files/char3A.png" style="height: 2px; width: 3px; 
margin-right: 0.062em;"><span class="icmr10">299</span>&nbsp;</span><span
 style="position: absolute; left: 0.166em; top: 0.125em;"><span 
class="icmsy10">−</span><span class="icmr10">0</span><img 
src="color_metric_files/char3A.png" style="height: 2px; width: 3px; 
margin-right: 0.062em;"><span class="icmr10">147</span>&nbsp;</span><span
 style="position: absolute; left: 0.429em; top: 1.644em;"><span 
class="icmr10">0</span><img src="color_metric_files/char3A.png" 
style="height: 2px; width: 3px; margin-right: 0.062em;"><span 
class="icmr10">615</span>&nbsp;</span><span style="position: absolute; 
left: 4.059em; top: -1.393em;"><span class="icmr10">0</span><img 
src="color_metric_files/char3A.png" style="height: 2px; width: 3px; 
margin-right: 0.062em;"><span class="icmr10">587</span>&nbsp;</span><span
 style="position: absolute; left: 3.796em; top: 0.125em;"><span 
class="icmsy10">−</span><span class="icmr10">0</span><img 
src="color_metric_files/char3A.png" style="height: 2px; width: 3px; 
margin-right: 0.062em;"><span class="icmr10">289</span>&nbsp;</span><span
 style="position: absolute; left: 3.796em; top: 1.644em;"><span 
class="icmsy10">−</span><span class="icmr10">0</span><img 
src="color_metric_files/char3A.png" style="height: 2px; width: 3px; 
margin-right: 0.062em;"><span class="icmr10">515</span>&nbsp;</span><span
 style="position: absolute; left: 7.689em; top: -1.393em;"><span 
class="icmr10">0</span><img src="color_metric_files/char3A.png" 
style="height: 2px; width: 3px; margin-right: 0.062em;"><span 
class="icmr10">114</span>&nbsp;</span><span style="position: absolute; 
left: 7.689em; top: 0.125em;"><span class="icmr10">0</span><img 
src="color_metric_files/char3A.png" style="height: 2px; width: 3px; 
margin-right: 0.062em;"><span class="icmr10">463</span>&nbsp;</span><span
 style="position: absolute; left: 7.426em; top: 1.644em;"><span 
class="icmsy10">−</span><span class="icmr10">0</span><img 
src="color_metric_files/char3A.png" style="height: 2px; width: 3px; 
margin-right: 0.062em;"><span class="icmr10">100</span>&nbsp;</span><span
 class="spacer" style="margin-left: 0.166em;"></span>&nbsp;</span><span 
class="blank" style="width: 10.223em; height: 4.391em; vertical-align: 
2.445em;"></span></span><span style="position: relative;"><span 
style="position: absolute; top: -2.26em; left: 0em;"><span 
style="position: absolute; left: 0em; top: 0em;"><img 
src="color_metric_files/char33.png" style="height: 26px; width: 5px; 
vertical-align: -25px; margin-right: 0.307em;">&nbsp;</span><span 
style="position: absolute; left: 0em; top: 1.71em;"><img 
src="color_metric_files/char37.png" style="height: 10px; width: 5px; 
vertical-align: -9px; margin-right: 0.307em;">&nbsp;</span><span 
style="position: absolute; left: 0em; top: 2.3em;"><img 
src="color_metric_files/char35.png" style="height: 26px; width: 5px; 
vertical-align: -25px; margin-right: 0.307em;">&nbsp;</span>&nbsp;</span><span
 class="blank" style="width: 0.676em; height: 1.052em; vertical-align: 
1.052em;"></span></span></span><span style="position: relative; 
margin-left: 0.166em;"><span style="position: relative;"><span 
style="position: absolute; top: -2.26em; left: 0em;"><span 
style="position: absolute; left: 0em; top: 0em;"><img 
src="color_metric_files/char32.png" style="height: 26px; width: 10px; 
vertical-align: -25px; margin-right: -0.052em;">&nbsp;</span><span 
style="position: absolute; left: 0em; top: 1.71em;"><img 
src="color_metric_files/char36.png" style="height: 10px; width: 6px; 
vertical-align: -9px; margin-right: 0.235em;">&nbsp;</span><span 
style="position: absolute; left: 0em; top: 2.3em;"><img 
src="color_metric_files/char34.png" style="height: 26px; width: 10px; 
vertical-align: -25px; margin-right: -0.052em;">&nbsp;</span>&nbsp;</span><span
 class="blank" style="width: 0.676em; height: 1.052em; vertical-align: 
1.052em;"></span></span><span style="position: relative;"><span 
style="position: absolute; top: 0em; left: 0em;"><span class="spacer" 
style="margin-left: 0.166em;"></span><span style="position: absolute; 
left: 0.204em; top: -1.393em;"><span class="icmmi10">R</span><span 
class="spacer" style="margin-left: 0.007em;"></span><span 
style="position: relative; top: -0.362em;"><span class="size2"><img 
src="color_metric_files/char30.png" style="height: 6px; width: 3px; 
margin-right: -0.034em;"></span><span class="spacer" style="margin-left:
 0.05em;"></span></span>&nbsp;</span><span style="position: absolute; 
left: 0.166em; top: 0.125em;"><span class="icmmi10">G</span><span 
style="position: relative; top: -0.362em;"><span class="size2"><img 
src="color_metric_files/char30.png" style="height: 6px; width: 3px; 
margin-right: -0.034em;"></span><span class="spacer" style="margin-left:
 0.05em;"></span></span>&nbsp;</span><span style="position: absolute; 
left: 0.166em; top: 1.644em;"><span class="icmmi10">B</span><span 
class="spacer" style="margin-left: 0.05em;"></span><span 
style="position: relative; top: -0.362em;"><span class="size2"><img 
src="color_metric_files/char30.png" style="height: 6px; width: 3px; 
margin-right: -0.034em;"></span><span class="spacer" style="margin-left:
 0.05em;"></span></span>&nbsp;</span><span class="spacer" 
style="margin-left: 0.166em;"></span>&nbsp;</span><span class="blank" 
style="width: 1.235em; height: 4.391em; vertical-align: 2.445em;"></span></span><span
 style="position: relative;"><span style="position: absolute; top: 
-2.26em; left: 0em;"><span style="position: absolute; left: 0em; top: 
0em;"><img src="color_metric_files/char33.png" style="height: 26px; 
width: 5px; vertical-align: -25px; margin-right: 0.307em;">&nbsp;</span><span
 style="position: absolute; left: 0em; top: 1.71em;"><img 
src="color_metric_files/char37.png" style="height: 10px; width: 5px; 
vertical-align: -9px; margin-right: 0.307em;">&nbsp;</span><span 
style="position: absolute; left: 0em; top: 2.3em;"><img 
src="color_metric_files/char35.png" style="height: 26px; width: 5px; 
vertical-align: -25px; margin-right: 0.307em;">&nbsp;</span>&nbsp;</span><span
 class="blank" style="width: 0.676em; height: 1.052em; vertical-align: 
1.052em;"></span></span></span><span class="blank" style="height: 
4.491em; vertical-align: 2.495em;"></span></span></nobr></div>
<p align="center"><small><b>R'G'B' to YUV</b></small>
</p><div class="typeset"><nobr><span class="scale"><span 
style="position: relative;"><span style="position: absolute; top: 
-2.26em; left: 0em;"><span style="position: absolute; left: 0em; top: 
0em;"><img src="color_metric_files/char32.png" style="height: 26px; 
width: 10px; vertical-align: -25px; margin-right: -0.052em;">&nbsp;</span><span
 style="position: absolute; left: 0em; top: 1.71em;"><img 
src="color_metric_files/char36.png" style="height: 10px; width: 6px; 
vertical-align: -9px; margin-right: 0.235em;">&nbsp;</span><span 
style="position: absolute; left: 0em; top: 2.3em;"><img 
src="color_metric_files/char34.png" style="height: 26px; width: 10px; 
vertical-align: -25px; margin-right: -0.052em;">&nbsp;</span>&nbsp;</span><span
 class="blank" style="width: 0.676em; height: 1.052em; vertical-align: 
1.052em;"></span></span><span style="position: relative;"><span 
style="position: absolute; top: 0em; left: 0em;"><span class="spacer" 
style="margin-left: 0.166em;"></span><span style="position: absolute; 
left: 0.166em; top: -1.393em;"><span class="icmmi10">Y</span><span 
class="spacer" style="margin-left: 0.222em;"></span>&nbsp;</span><span 
style="position: absolute; left: 0.354em; top: 0.125em;"><span 
class="icmmi10">I</span><span class="spacer" style="margin-left: 
0.078em;"></span>&nbsp;</span><span style="position: absolute; left: 
0.204em; top: 1.644em;"><span class="icmmi10">Q</span>&nbsp;</span><span
 class="spacer" style="margin-left: 0.166em;"></span>&nbsp;</span><span 
class="blank" style="width: 1.084em; height: 4.391em; vertical-align: 
2.445em;"></span></span><span style="position: relative;"><span 
style="position: absolute; top: -2.26em; left: 0em;"><span 
style="position: absolute; left: 0em; top: 0em;"><img 
src="color_metric_files/char33.png" style="height: 26px; width: 5px; 
vertical-align: -25px; margin-right: 0.307em;">&nbsp;</span><span 
style="position: absolute; left: 0em; top: 1.71em;"><img 
src="color_metric_files/char37.png" style="height: 10px; width: 5px; 
vertical-align: -9px; margin-right: 0.307em;">&nbsp;</span><span 
style="position: absolute; left: 0em; top: 2.3em;"><img 
src="color_metric_files/char35.png" style="height: 26px; width: 5px; 
vertical-align: -25px; margin-right: 0.307em;">&nbsp;</span>&nbsp;</span><span
 class="blank" style="width: 0.676em; height: 1.052em; vertical-align: 
1.052em;"></span></span><span style="position: relative; margin-left: 
0.277em;"><span class="icmr10">=</span></span><span style="position: 
relative; margin-left: 0.277em;"><span style="position: relative;"><span
 style="position: absolute; top: -2.26em; left: 0em;"><span 
style="position: absolute; left: 0em; top: 0em;"><img 
src="color_metric_files/char32.png" style="height: 26px; width: 10px; 
vertical-align: -25px; margin-right: -0.052em;">&nbsp;</span><span 
style="position: absolute; left: 0em; top: 1.71em;"><img 
src="color_metric_files/char36.png" style="height: 10px; width: 6px; 
vertical-align: -9px; margin-right: 0.235em;">&nbsp;</span><span 
style="position: absolute; left: 0em; top: 2.3em;"><img 
src="color_metric_files/char34.png" style="height: 26px; width: 10px; 
vertical-align: -25px; margin-right: -0.052em;">&nbsp;</span>&nbsp;</span><span
 class="blank" style="width: 0.676em; height: 1.052em; vertical-align: 
1.052em;"></span></span><span style="position: relative;"><span 
style="position: absolute; top: 0em; left: 0em;"><span class="spacer" 
style="margin-left: 0.166em;"></span><span style="position: absolute; 
left: 0.166em; top: -1.393em;"><span class="icmr10">0</span><img 
src="color_metric_files/char3A.png" style="height: 2px; width: 3px; 
margin-right: 0.062em;"><span class="icmr10">299</span>&nbsp;</span><span
 style="position: absolute; left: 0.166em; top: 0.125em;"><span 
class="icmr10">0</span><img src="color_metric_files/char3A.png" 
style="height: 2px; width: 3px; margin-right: 0.062em;"><span 
class="icmr10">595</span>&nbsp;</span><span style="position: absolute; 
left: 0.166em; top: 1.644em;"><span class="icmr10">0</span><img 
src="color_metric_files/char3A.png" style="height: 2px; width: 3px; 
margin-right: 0.062em;"><span class="icmr10">211</span>&nbsp;</span><span
 style="position: absolute; left: 3.533em; top: -1.393em;"><span 
class="icmr10">0</span><img src="color_metric_files/char3A.png" 
style="height: 2px; width: 3px; margin-right: 0.062em;"><span 
class="icmr10">587</span>&nbsp;</span><span style="position: absolute; 
left: 3.27em; top: 0.125em;"><span class="icmsy10">−</span><span 
class="icmr10">0</span><img src="color_metric_files/char3A.png" 
style="height: 2px; width: 3px; margin-right: 0.062em;"><span 
class="icmr10">274</span>&nbsp;</span><span style="position: absolute; 
left: 3.27em; top: 1.644em;"><span class="icmsy10">−</span><span 
class="icmr10">0</span><img src="color_metric_files/char3A.png" 
style="height: 2px; width: 3px; margin-right: 0.062em;"><span 
class="icmr10">523</span>&nbsp;</span><span style="position: absolute; 
left: 7.163em; top: -1.393em;"><span class="icmr10">0</span><img 
src="color_metric_files/char3A.png" style="height: 2px; width: 3px; 
margin-right: 0.062em;"><span class="icmr10">114</span>&nbsp;</span><span
 style="position: absolute; left: 6.9em; top: 0.125em;"><span 
class="icmsy10">−</span><span class="icmr10">0</span><img 
src="color_metric_files/char3A.png" style="height: 2px; width: 3px; 
margin-right: 0.062em;"><span class="icmr10">322</span>&nbsp;</span><span
 style="position: absolute; left: 7.163em; top: 1.644em;"><span 
class="icmr10">0</span><img src="color_metric_files/char3A.png" 
style="height: 2px; width: 3px; margin-right: 0.062em;"><span 
class="icmr10">312</span>&nbsp;</span><span class="spacer" 
style="margin-left: 0.166em;"></span>&nbsp;</span><span class="blank" 
style="width: 9.697em; height: 4.391em; vertical-align: 2.445em;"></span></span><span
 style="position: relative;"><span style="position: absolute; top: 
-2.26em; left: 0em;"><span style="position: absolute; left: 0em; top: 
0em;"><img src="color_metric_files/char33.png" style="height: 26px; 
width: 5px; vertical-align: -25px; margin-right: 0.307em;">&nbsp;</span><span
 style="position: absolute; left: 0em; top: 1.71em;"><img 
src="color_metric_files/char37.png" style="height: 10px; width: 5px; 
vertical-align: -9px; margin-right: 0.307em;">&nbsp;</span><span 
style="position: absolute; left: 0em; top: 2.3em;"><img 
src="color_metric_files/char35.png" style="height: 26px; width: 5px; 
vertical-align: -25px; margin-right: 0.307em;">&nbsp;</span>&nbsp;</span><span
 class="blank" style="width: 0.676em; height: 1.052em; vertical-align: 
1.052em;"></span></span></span><span style="position: relative; 
margin-left: 0.166em;"><span style="position: relative;"><span 
style="position: absolute; top: -2.26em; left: 0em;"><span 
style="position: absolute; left: 0em; top: 0em;"><img 
src="color_metric_files/char32.png" style="height: 26px; width: 10px; 
vertical-align: -25px; margin-right: -0.052em;">&nbsp;</span><span 
style="position: absolute; left: 0em; top: 1.71em;"><img 
src="color_metric_files/char36.png" style="height: 10px; width: 6px; 
vertical-align: -9px; margin-right: 0.235em;">&nbsp;</span><span 
style="position: absolute; left: 0em; top: 2.3em;"><img 
src="color_metric_files/char34.png" style="height: 26px; width: 10px; 
vertical-align: -25px; margin-right: -0.052em;">&nbsp;</span>&nbsp;</span><span
 class="blank" style="width: 0.676em; height: 1.052em; vertical-align: 
1.052em;"></span></span><span style="position: relative;"><span 
style="position: absolute; top: 0em; left: 0em;"><span class="spacer" 
style="margin-left: 0.166em;"></span><span style="position: absolute; 
left: 0.204em; top: -1.393em;"><span class="icmmi10">R</span><span 
class="spacer" style="margin-left: 0.007em;"></span><span 
style="position: relative; top: -0.362em;"><span class="size2"><img 
src="color_metric_files/char30.png" style="height: 6px; width: 3px; 
margin-right: -0.034em;"></span><span class="spacer" style="margin-left:
 0.05em;"></span></span>&nbsp;</span><span style="position: absolute; 
left: 0.166em; top: 0.125em;"><span class="icmmi10">G</span><span 
style="position: relative; top: -0.362em;"><span class="size2"><img 
src="color_metric_files/char30.png" style="height: 6px; width: 3px; 
margin-right: -0.034em;"></span><span class="spacer" style="margin-left:
 0.05em;"></span></span>&nbsp;</span><span style="position: absolute; 
left: 0.166em; top: 1.644em;"><span class="icmmi10">B</span><span 
class="spacer" style="margin-left: 0.05em;"></span><span 
style="position: relative; top: -0.362em;"><span class="size2"><img 
src="color_metric_files/char30.png" style="height: 6px; width: 3px; 
margin-right: -0.034em;"></span><span class="spacer" style="margin-left:
 0.05em;"></span></span>&nbsp;</span><span class="spacer" 
style="margin-left: 0.166em;"></span>&nbsp;</span><span class="blank" 
style="width: 1.235em; height: 4.391em; vertical-align: 2.445em;"></span></span><span
 style="position: relative;"><span style="position: absolute; top: 
-2.26em; left: 0em;"><span style="position: absolute; left: 0em; top: 
0em;"><img src="color_metric_files/char33.png" style="height: 26px; 
width: 5px; vertical-align: -25px; margin-right: 0.307em;">&nbsp;</span><span
 style="position: absolute; left: 0em; top: 1.71em;"><img 
src="color_metric_files/char37.png" style="height: 10px; width: 5px; 
vertical-align: -9px; margin-right: 0.307em;">&nbsp;</span><span 
style="position: absolute; left: 0em; top: 2.3em;"><img 
src="color_metric_files/char35.png" style="height: 26px; width: 5px; 
vertical-align: -25px; margin-right: 0.307em;">&nbsp;</span>&nbsp;</span><span
 class="blank" style="width: 0.676em; height: 1.052em; vertical-align: 
1.052em;"></span></span></span><span class="blank" style="height: 
4.491em; vertical-align: 2.495em;"></span></span></nobr></div>
<p align="center"><small><b>R'G'B' to YIQ</b></small>
</p><p>By the way, the "Y" of YUV and YIQ is the gamma corrected 
"brightness" component of
the colour; the "Y" of the CIE XYZ model is linear (<em>= uncorrected</em>)
brightness. Both are related, but they are not the same.
</p><p>Other colour models have been developed with the goals of being 
easy to
compute and making better use of the features and limitations of the 
human
visual system. The document by <a href="#GRANGER">E.M. Granger</a> 
mentions the
Guth ADT colour space, and <a href="#POYNTON2">Charles A. Poynton</a> 
wrote in
his "colorspace-faq": "Although it was not specifically
optimized for this purpose, the non-linear R'G'B' coding [...] is quite
perceptually uniform".
</p><p>To recapitulate, and to set out a direction towards a solution:
</p><ul>
<li>What we need is a formula that gives a "distance" between two
colours. This distance will only be used in comparisons, to verify 
whether
one colour, <i>A</i>, is closer to colour <i>B</i> or to colour
<i>C</i>.</li>
<li>In a perceptually uniform colour space, the Euclidean distance 
function
gives this distance. This is the most straightforward (and obvious)
solution, but not the <i>only</i> solution.</li>
<li>There are three well-known colour models (CIE
L<sup>*</sup>u<sup>*</sup>v<sup>*</sup>, YUV and R'G'B') that all score
"quite well" in perceptual uniformity (or so they say...).</li>
<li>The proper test for these and other formulae is to compare their 
choice
of "the closest colour" to the colour that a person would
pick.</li>
</ul>
<p>With the last point in mind, I wrote a small program that creates a 
palette
with colours from an RGB cube that is cut into 64 small cubes (two bits 
for
each red, green and blue component, giving
<span class="typeset"><nobr><span class="scale"><span class="icmr10">2</span><span
 style="position: relative; top: -0.362em;"><span class="size2"><span 
class="icmr10">2</span></span><span class="spacer" style="margin-left: 
0.05em;"></span></span><span style="position: relative; margin-left: 
0.222em;"><img src="color_metric_files/char02.png" style="height: 7px; 
width: 9px; margin-right: 0.13em;"></span><span style="position: 
relative; margin-left: 0.222em;"><span class="icmr10">2</span><span 
style="position: relative; top: -0.362em;"><span class="size2"><span 
class="icmr10">2</span></span><span class="spacer" style="margin-left: 
0.05em;"></span></span></span><span style="position: relative; 
margin-left: 0.222em;"><img src="color_metric_files/char02.png" 
style="height: 7px; width: 9px; margin-right: 0.13em;"></span><span 
style="position: relative; margin-left: 0.222em;"><span class="icmr10">2</span><span
 style="position: relative; top: -0.362em;"><span class="size2"><span 
class="icmr10">2</span></span><span class="spacer" style="margin-left: 
0.05em;"></span></span></span><span style="position: relative; 
margin-left: 0.277em;"><span class="icmr10">=</span></span><span 
style="position: relative; margin-left: 0.277em;"><span class="icmr10">6</span></span><span
 class="icmr10">4</span></span></nobr></span> colours).
The program displays one colour from the palette, e.g. colour 24, and 
the
tester chooses the closest colour from the remaining 63 palette entries.
</p><p>The next step is to let the program automatically choose the 
closest
colour using any of the aforementioned colour spaces.
</p><p>Note that the goal of my program is <em>not</em> to find the 
smallest
noticeable difference in tint from one colour pad to the next; the 
colours that
one of my "observers" may use to match to another colour are obviously
different. My intent is to let them select the closest entry in order to
 gain
insight in how people evaluate colour "closeness".
</p><h2>The results</h2>
<p>Due to the small size of the test group that I used in this 
experiment, the
results below should perhaps be considered anecdotal.
</p><ul>
<li>Not surprisingly, the choice of the "correct" colour is
subjective. One person may find the proper brightness more important 
than the
proper hue, others feel that the replacement colour should approximate 
the
hue and saturation as best as possible. Therefore, you will not find a 
single
formula that suits everyone.</li>
<li><b>Non-linear R'G'B'</b> is only fair. In many cases, it selects 
colours
that are too dark or too blue.</li>
<li><b>YUV</b> is always better then non-linear R'G'B', but it is far 
from
perfect.</li>
<li><b>CIE L<sup>*</sup>u<sup>*</sup>v<sup>*</sup></b> makes many 
excellent
choices, but in a few situations, it makes unacceptable errors. The 
modified
CIE L<sup>*</sup>u<sup>*</sup>v<sup>* </sup>from [<a href="#GRANGER">Granger</a>]
performs much better (the document by E.M. Granger suggested to use a
<i>square</i> root for the L<sup>*</sup>, instead of the standardized
<i>cube</i> root, [<a href="#NEMCSICS">Nemcsics, 1993</a>] comes to the 
same
conclusion). But even with the modified lightness curve,
L<sup>*</sup>u<sup>*</sup>v<sup>*<b> </b></sup>does not perform well in 
the
range of pink colours (skin colours of the Caucasian race).</li>
<li>Several individuals suggested a <b>weighted Euclidean distance in 
R'G'B'</b>,
according to the formula:
<div class="typeset"><nobr><span class="scale"><span style="position: 
relative;"><span style="position: absolute; top: 0em; left: 0em;"><span 
style="position: relative; top: 0.025em;"><img 
src="color_metric_files/char6B.png" style="height: 15px; width: 6px; 
vertical-align: -4px; margin-right: 0.068em;"></span><img 
src="color_metric_files/char01.png" style="height: 11px; width: 11px; 
margin-right: 0.041em;"><span class="icmmi10">C</span><span 
class="spacer" style="margin-left: 0.071em;"></span><span 
style="position: relative; top: 0.025em;"><img 
src="color_metric_files/char6B.png" style="height: 15px; width: 6px; 
vertical-align: -4px; margin-right: 0.068em;"></span><span 
style="position: relative; margin-left: 0.277em;"><span class="icmr10">=</span></span><span
 style="position: relative; margin-left: 0.277em;"><span 
style="position: relative; top: -1.055em;"><span style="position: 
relative; top: 0.05em;"><img src="color_metric_files/char70.png" 
style="height: 18px; width: 15px; vertical-align: -17px; margin-right: 
-0.079em;"></span></span><span style="position: relative; top: 
-1.025em;"><span class="blank" style="border-left: 13.601em solid; 
height: 1.5px; vertical-align: 0.112em;"></span></span><span 
style="position: relative; margin-left: -13.601em;"><span class="icmr10">3</span><span
 style="position: relative; margin-left: 0.222em;"><img 
src="color_metric_files/char02.png" style="height: 7px; width: 9px; 
margin-right: 0.13em;"></span><span style="position: relative; 
margin-left: 0.222em;"><img src="color_metric_files/char01.png" 
style="height: 11px; width: 11px; margin-right: 0.041em;"></span><span 
class="icmmi10">R</span><span class="spacer" style="margin-left: 
0.007em;"></span><span style="position: relative; top: -0.288em;"><span 
class="size2"><img src="color_metric_files/char30.png" style="height: 
6px; width: 3px; margin-right: -0.034em;"></span><span class="spacer" 
style="margin-left: 0.05em;"></span></span><span style="position: 
relative; top: -0.288em;"><span class="size2"><span class="icmr10">2</span></span><span
 class="spacer" style="margin-left: 0.05em;"></span></span><span 
style="position: relative; margin-left: 0.222em;"><span class="icmr10">+</span></span><span
 style="position: relative; margin-left: 0.222em;"><span class="icmr10">4</span></span><span
 style="position: relative; margin-left: 0.222em;"><img 
src="color_metric_files/char02.png" style="height: 7px; width: 9px; 
margin-right: 0.13em;"></span><span style="position: relative; 
margin-left: 0.222em;"><img src="color_metric_files/char01.png" 
style="height: 11px; width: 11px; margin-right: 0.041em;"></span><span 
class="icmmi10">G</span><span style="position: relative; top: -0.288em;"><span
 class="size2"><img src="color_metric_files/char30.png" style="height: 
6px; width: 3px; margin-right: -0.034em;"></span><span class="spacer" 
style="margin-left: 0.05em;"></span></span><span style="position: 
relative; top: -0.288em;"><span class="size2"><span class="icmr10">2</span></span><span
 class="spacer" style="margin-left: 0.05em;"></span></span><span 
style="position: relative; margin-left: 0.222em;"><span class="icmr10">+</span></span><span
 style="position: relative; margin-left: 0.222em;"><span class="icmr10">2</span></span><span
 style="position: relative; margin-left: 0.222em;"><img 
src="color_metric_files/char02.png" style="height: 7px; width: 9px; 
margin-right: 0.13em;"></span><span style="position: relative; 
margin-left: 0.222em;"><img src="color_metric_files/char01.png" 
style="height: 11px; width: 11px; margin-right: 0.041em;"></span><span 
class="icmmi10">B</span><span class="spacer" style="margin-left: 
0.05em;"></span><span style="position: relative; top: -0.288em;"><span 
class="size2"><img src="color_metric_files/char30.png" style="height: 
6px; width: 3px; margin-right: -0.034em;"></span><span class="spacer" 
style="margin-left: 0.05em;"></span></span><span style="position: 
relative; top: -0.288em;"><span class="size2"><span class="icmr10">2</span></span><span
 class="spacer" style="margin-left: 0.05em;"></span></span></span></span>&nbsp;</span><span
 class="blank" style="width: 18.41em; height: 1.052em; vertical-align: 
1.052em;"></span></span><span class="blank" style="height: 1.55em; 
vertical-align: 1.225em;"></span></span></nobr></div>
<p>This function has practically the same result as YUV. Its simplicity 
and speed
of calculation make it a better choice than YUV.
</p></li><li>As explained in the section "gamma correction" below, the 
perception of
brightness by the human eye is non-linear. From the experiments it 
appears
that the curve for this non-linearity is not the same for each colour. 
The
weighted Euclidean distance presented works quite well for the subset of
colours where the "red" signal is 128 or more (on a scale of 0-255). For
 the
other half of the full R'G'B' cube, this different weighting produced 
better
results:
<div class="typeset"><nobr><span class="scale"><span style="position: 
relative;"><span style="position: absolute; top: 0em; left: 0em;"><span 
style="position: relative; top: 0.025em;"><img 
src="color_metric_files/char6B.png" style="height: 15px; width: 6px; 
vertical-align: -4px; margin-right: 0.068em;"></span><img 
src="color_metric_files/char01.png" style="height: 11px; width: 11px; 
margin-right: 0.041em;"><span class="icmmi10">C</span><span 
class="spacer" style="margin-left: 0.071em;"></span><span 
style="position: relative; top: 0.025em;"><img 
src="color_metric_files/char6B.png" style="height: 15px; width: 6px; 
vertical-align: -4px; margin-right: 0.068em;"></span><span 
style="position: relative; margin-left: 0.277em;"><span class="icmr10">=</span></span><span
 style="position: relative; margin-left: 0.277em;"><span 
style="position: relative; top: -1.055em;"><span style="position: 
relative; top: 0.05em;"><img src="color_metric_files/char70.png" 
style="height: 18px; width: 15px; vertical-align: -17px; margin-right: 
-0.079em;"></span></span><span style="position: relative; top: 
-1.025em;"><span class="blank" style="border-left: 13.601em solid; 
height: 1.5px; vertical-align: 0.112em;"></span></span><span 
style="position: relative; margin-left: -13.601em;"><span class="icmr10">2</span><span
 style="position: relative; margin-left: 0.222em;"><img 
src="color_metric_files/char02.png" style="height: 7px; width: 9px; 
margin-right: 0.13em;"></span><span style="position: relative; 
margin-left: 0.222em;"><img src="color_metric_files/char01.png" 
style="height: 11px; width: 11px; margin-right: 0.041em;"></span><span 
class="icmmi10">R</span><span class="spacer" style="margin-left: 
0.007em;"></span><span style="position: relative; top: -0.288em;"><span 
class="size2"><img src="color_metric_files/char30.png" style="height: 
6px; width: 3px; margin-right: -0.034em;"></span><span class="spacer" 
style="margin-left: 0.05em;"></span></span><span style="position: 
relative; top: -0.288em;"><span class="size2"><span class="icmr10">2</span></span><span
 class="spacer" style="margin-left: 0.05em;"></span></span><span 
style="position: relative; margin-left: 0.222em;"><span class="icmr10">+</span></span><span
 style="position: relative; margin-left: 0.222em;"><span class="icmr10">4</span></span><span
 style="position: relative; margin-left: 0.222em;"><img 
src="color_metric_files/char02.png" style="height: 7px; width: 9px; 
margin-right: 0.13em;"></span><span style="position: relative; 
margin-left: 0.222em;"><img src="color_metric_files/char01.png" 
style="height: 11px; width: 11px; margin-right: 0.041em;"></span><span 
class="icmmi10">G</span><span style="position: relative; top: -0.288em;"><span
 class="size2"><img src="color_metric_files/char30.png" style="height: 
6px; width: 3px; margin-right: -0.034em;"></span><span class="spacer" 
style="margin-left: 0.05em;"></span></span><span style="position: 
relative; top: -0.288em;"><span class="size2"><span class="icmr10">2</span></span><span
 class="spacer" style="margin-left: 0.05em;"></span></span><span 
style="position: relative; margin-left: 0.222em;"><span class="icmr10">+</span></span><span
 style="position: relative; margin-left: 0.222em;"><span class="icmr10">3</span></span><span
 style="position: relative; margin-left: 0.222em;"><img 
src="color_metric_files/char02.png" style="height: 7px; width: 9px; 
margin-right: 0.13em;"></span><span style="position: relative; 
margin-left: 0.222em;"><img src="color_metric_files/char01.png" 
style="height: 11px; width: 11px; margin-right: 0.041em;"></span><span 
class="icmmi10">B</span><span class="spacer" style="margin-left: 
0.05em;"></span><span style="position: relative; top: -0.288em;"><span 
class="size2"><img src="color_metric_files/char30.png" style="height: 
6px; width: 3px; margin-right: -0.034em;"></span><span class="spacer" 
style="margin-left: 0.05em;"></span></span><span style="position: 
relative; top: -0.288em;"><span class="size2"><span class="icmr10">2</span></span><span
 class="spacer" style="margin-left: 0.05em;"></span></span></span></span>&nbsp;</span><span
 class="blank" style="width: 18.41em; height: 1.052em; vertical-align: 
1.052em;"></span></span><span class="blank" style="height: 1.55em; 
vertical-align: 1.225em;"></span></span></nobr></div>
<p>Although blue has a small contribution (about 10%) to the sensation 
of
brightness, human vision has an extraordinarily good colour 
discrimination
capability in blue colours [<a href="#POYNTON2">Poynton, 1999</a>]. This
might explain why colours with a large "blue" contribution need
a different weighting than colours with little blue.
</p></li></ul>
<h2>A low-cost approximation</h2>
<p>The proposed algorithm (used by our products <a 
href="http://www.compuphase.com/software_egi.htm">EGI</a>,
<a href="http://www.compuphase.com/software_anisprite.htm">AniSprite</a>
 and <a href="http://www.compuphase.com/software_palettemaker.htm">PaletteMaker</a>)
is a combination both weighted Euclidean distance functions,
where the weight factors depend on how big the "red" component of
the colour is. First one calculates the mean level of "red" and
then weights the <span class="typeset"><nobr><span class="scale"><img 
src="color_metric_files/char01.png" style="height: 11px; width: 11px; 
margin-right: 0.041em;"><span class="icmmi10">R</span><span 
class="spacer" style="margin-left: 0.007em;"></span><span 
style="position: relative; top: -0.362em;"><span class="size2"><img 
src="color_metric_files/char30.png" style="height: 6px; width: 3px; 
margin-right: -0.034em;"></span><span class="spacer" style="margin-left:
 0.05em;"></span></span></span></nobr></span> and
<span class="typeset"><nobr><span class="scale"><img 
src="color_metric_files/char01.png" style="height: 11px; width: 11px; 
margin-right: 0.041em;"><span class="icmmi10">B</span><span 
class="spacer" style="margin-left: 0.05em;"></span><span 
style="position: relative; top: -0.362em;"><span class="size2"><img 
src="color_metric_files/char30.png" style="height: 6px; width: 3px; 
margin-right: -0.034em;"></span><span class="spacer" style="margin-left:
 0.05em;"></span></span></span></nobr></span> signals as a function of 
the mean red
level. The distance between colours C<sub>1</sub> and C<sub>2</sub> 
(where
each of the red, green and blue channels has a range of 0-255) is:
</p><div class="typeset"><nobr><span class="scale"><span 
style="position: relative;"><span style="position: absolute; top: 0em; 
left: 0em;"><span class="spacer" style="margin-left: 0.166em;"></span><span
 style="position: absolute; left: 0.444em; top: -4.565em;"><span 
class="icmmi10">r</span><span class="spacer" style="margin-left: 
0.027em;"></span><span style="position: relative; margin-left: -0.382em;
 top: -0.043em;"><img src="color_metric_files/char16.png" style="height:
 2px; width: 7px; vertical-align: 7px;"></span><span class="spacer" 
style="margin-left: -0.117em;"></span><span style="position: relative; 
margin-left: 0.277em;"><span class="icmr10">=</span></span><span 
style="position: relative; margin-left: 0.277em;"><span class="spacer" 
style="margin-left: 0.12em;"></span><span style="position: relative; 
margin-left: 2.028em; top: 0.713em;"><span class="icmr10">2</span></span><span
 style="position: relative; margin-left: -2.479em; top: -0.882em;"><span
 class="icmmi10">C</span><span style="position: relative; top: 0.286em;"><span
 class="size2"><span class="icmr10">1</span><img 
src="color_metric_files/char3B.png" style="height: 4px; width: 3px; 
vertical-align: -2px; margin-right: -0.031em;"></span><span 
class="size2"><span class="icmmi10">R</span></span><span class="spacer" 
style="margin-left: 0.005em;"></span><span class="spacer" 
style="margin-left: 0.05em;"></span></span><span style="position: 
relative; margin-left: 0.222em;"><span class="icmr10">+</span></span><span
 style="position: relative; margin-left: 0.222em;"><span class="icmmi10">C</span><span
 style="position: relative; top: 0.286em;"><span class="size2"><span 
class="icmr10">2</span><img src="color_metric_files/char3B.png" 
style="height: 4px; width: 3px; vertical-align: -2px; margin-right: 
-0.031em;"></span><span class="size2"><span class="icmmi10">R</span></span><span
 class="spacer" style="margin-left: 0.005em;"></span><span 
class="spacer" style="margin-left: 0.05em;"></span></span></span></span><span
 style="position: relative; margin-left: -4.508em; top: -0.22em;"><span 
class="blank" style="border-left: 4.508em solid; height: 1.5px; 
vertical-align: 0.112em;"></span></span><span class="spacer" 
style="margin-left: 0.12em;"></span></span>&nbsp;</span><span 
style="position: absolute; left: 0.444em; top: -2.299em;"><img 
src="color_metric_files/char01.png" style="height: 11px; width: 11px; 
margin-right: 0.041em;"><span class="icmmi10">R</span><span 
class="spacer" style="margin-left: 0.007em;"></span><span 
style="position: relative; margin-left: 0.277em;"><span class="icmr10">=</span></span><span
 style="position: relative; margin-left: 0.277em;"><span class="icmmi10">C</span><span
 style="position: relative; top: 0.286em;"><span class="size2"><span 
class="icmr10">1</span><img src="color_metric_files/char3B.png" 
style="height: 4px; width: 3px; vertical-align: -2px; margin-right: 
-0.031em;"></span><span class="size2"><span class="icmmi10">R</span></span><span
 class="spacer" style="margin-left: 0.005em;"></span><span 
class="spacer" style="margin-left: 0.05em;"></span></span></span><span 
style="position: relative; margin-left: 0.222em;"><span class="icmsy10">−</span></span><span
 style="position: relative; margin-left: 0.222em;"><span class="icmmi10">C</span><span
 style="position: relative; top: 0.286em;"><span class="size2"><span 
class="icmr10">2</span><img src="color_metric_files/char3B.png" 
style="height: 4px; width: 3px; vertical-align: -2px; margin-right: 
-0.031em;"></span><span class="size2"><span class="icmmi10">R</span></span><span
 class="spacer" style="margin-left: 0.005em;"></span><span 
class="spacer" style="margin-left: 0.05em;"></span></span></span>&nbsp;</span><span
 style="position: absolute; left: 0.444em; top: -0.325em;"><img 
src="color_metric_files/char01.png" style="height: 11px; width: 11px; 
margin-right: 0.041em;"><span class="icmmi10">G</span><span 
style="position: relative; margin-left: 0.277em;"><span class="icmr10">=</span></span><span
 style="position: relative; margin-left: 0.277em;"><span class="icmmi10">C</span><span
 style="position: relative; top: 0.286em;"><span class="size2"><span 
class="icmr10">1</span><img src="color_metric_files/char3B.png" 
style="height: 4px; width: 3px; vertical-align: -2px; margin-right: 
-0.031em;"><span class="icmmi10">G</span></span><span class="spacer" 
style="margin-left: 0.05em;"></span></span></span><span style="position:
 relative; margin-left: 0.222em;"><span class="icmsy10">−</span></span><span
 style="position: relative; margin-left: 0.222em;"><span class="icmmi10">C</span><span
 style="position: relative; top: 0.286em;"><span class="size2"><span 
class="icmr10">2</span><img src="color_metric_files/char3B.png" 
style="height: 4px; width: 3px; vertical-align: -2px; margin-right: 
-0.031em;"><span class="icmmi10">G</span></span><span class="spacer" 
style="margin-left: 0.05em;"></span></span></span>&nbsp;</span><span 
style="position: absolute; left: 0.444em; top: 1.648em;"><img 
src="color_metric_files/char01.png" style="height: 11px; width: 11px; 
margin-right: 0.041em;"><span class="icmmi10">B</span><span 
class="spacer" style="margin-left: 0.05em;"></span><span 
style="position: relative; margin-left: 0.277em;"><span class="icmr10">=</span></span><span
 style="position: relative; margin-left: 0.277em;"><span class="icmmi10">C</span><span
 style="position: relative; top: 0.286em;"><span class="size2"><span 
class="icmr10">1</span><img src="color_metric_files/char3B.png" 
style="height: 4px; width: 3px; vertical-align: -2px; margin-right: 
-0.031em;"></span><span class="size2"><span class="icmmi10">B</span></span><span
 class="spacer" style="margin-left: 0.035em;"></span><span 
class="spacer" style="margin-left: 0.05em;"></span></span></span><span 
style="position: relative; margin-left: 0.222em;"><span class="icmsy10">−</span></span><span
 style="position: relative; margin-left: 0.222em;"><span class="icmmi10">C</span><span
 style="position: relative; top: 0.286em;"><span class="size2"><span 
class="icmr10">2</span><img src="color_metric_files/char3B.png" 
style="height: 4px; width: 3px; vertical-align: -2px; margin-right: 
-0.031em;"></span><span class="size2"><span class="icmmi10">B</span></span><span
 class="spacer" style="margin-left: 0.035em;"></span><span 
class="spacer" style="margin-left: 0.05em;"></span></span></span>&nbsp;</span><span
 style="position: absolute; left: 0.444em; top: 4.529em;"><img 
src="color_metric_files/char01.png" style="height: 11px; width: 11px; 
margin-right: 0.041em;"><span class="icmmi10">C</span><span 
class="spacer" style="margin-left: 0.071em;"></span><span 
style="position: relative; margin-left: 0.277em;"><span class="icmr10">=</span></span><span
 style="position: relative; margin-left: 0.277em;"><span 
style="position: relative; top: -1.838em;"><span style="position: 
relative; top: 0.05em;"><img src="color_metric_files/char73.png" 
style="height: 43px; width: 15px; vertical-align: -42px; margin-right: 
-0.079em;"></span></span><span style="position: relative; top: 
-1.808em;"><span class="blank" style="border-left: 22.393em solid; 
height: 1.5px; vertical-align: 0.112em;"></span></span><span 
style="position: relative; margin-left: -22.393em;"><span 
style="position: relative; top: -1.385em;"><img 
src="color_metric_files/char12.png" style="height: 35px; width: 10px; 
vertical-align: -34px; margin-right: 0.016em;"></span><span 
class="icmr10">2</span><span style="position: relative; margin-left: 
0.222em;"><span class="icmr10">+</span></span><span style="position: 
relative; margin-left: 0.222em;"><span class="spacer" 
style="margin-left: 0.12em;"></span><span style="position: relative; 
margin-left: 0.45em; top: -0.676em;"><span class="icmmi10">r</span><span
 class="spacer" style="margin-left: 0.027em;"></span><span 
style="position: relative; margin-left: -0.382em; top: -0.043em;"><img 
src="color_metric_files/char16.png" style="height: 2px; width: 7px; 
vertical-align: 7px;"></span><span class="spacer" style="margin-left: 
-0.117em;"></span></span><span style="position: relative; margin-left: 
-0.901em; top: 0.713em;"><span class="icmr10">256</span></span><span 
style="position: relative; margin-left: -1.352em; top: -0.22em;"><span 
class="blank" style="border-left: 1.352em solid; height: 1.5px; 
vertical-align: 0.112em;"></span></span><span class="spacer" 
style="margin-left: 0.12em;"></span></span><span style="position: 
relative; top: -1.385em;"><img src="color_metric_files/char13.png" 
style="height: 35px; width: 8px; vertical-align: -34px; margin-right: 
0.16em;"></span><span style="position: relative; margin-left: 0.222em;"><img
 src="color_metric_files/char02.png" style="height: 7px; width: 9px; 
margin-right: 0.13em;"></span><span style="position: relative; 
margin-left: 0.222em;"><img src="color_metric_files/char01.png" 
style="height: 11px; width: 11px; margin-right: 0.041em;"></span><span 
class="icmmi10">R</span><span class="spacer" style="margin-left: 
0.007em;"></span><span style="position: relative; top: -0.288em;"><span 
class="size2"><span class="icmr10">2</span></span><span class="spacer" 
style="margin-left: 0.05em;"></span></span><span style="position: 
relative; margin-left: 0.222em;"><span class="icmr10">+</span></span><span
 style="position: relative; margin-left: 0.222em;"><span class="icmr10">4</span></span><span
 style="position: relative; margin-left: 0.222em;"><img 
src="color_metric_files/char02.png" style="height: 7px; width: 9px; 
margin-right: 0.13em;"></span><span style="position: relative; 
margin-left: 0.222em;"><img src="color_metric_files/char01.png" 
style="height: 11px; width: 11px; margin-right: 0.041em;"></span><span 
class="icmmi10">G</span><span style="position: relative; top: -0.288em;"><span
 class="size2"><span class="icmr10">2</span></span><span class="spacer" 
style="margin-left: 0.05em;"></span></span><span style="position: 
relative; margin-left: 0.222em;"><span class="icmr10">+</span></span><span
 style="position: relative; margin-left: 0.222em;"><span 
style="position: relative; top: -1.385em;"><img 
src="color_metric_files/char12.png" style="height: 35px; width: 10px; 
vertical-align: -34px; margin-right: 0.016em;"></span><span 
class="icmr10">2</span><span style="position: relative; margin-left: 
0.222em;"><span class="icmr10">+</span></span><span style="position: 
relative; margin-left: 0.222em;"><span class="spacer" 
style="margin-left: 0.12em;"></span><span style="position: relative; 
margin-left: 0.713em; top: 0.713em;"><span class="icmr10">256</span></span><span
 style="position: relative; margin-left: -2.066em; top: -0.676em;"><span
 class="icmr10">255</span><span style="position: relative; margin-left: 
0.222em;"><span class="icmsy10">−</span></span><span style="position: 
relative; margin-left: 0.222em;"><span class="icmmi10">r</span><span 
class="spacer" style="margin-left: 0.027em;"></span><span 
style="position: relative; margin-left: -0.382em; top: -0.043em;"><img 
src="color_metric_files/char16.png" style="height: 2px; width: 7px; 
vertical-align: 7px;"></span><span class="spacer" style="margin-left: 
-0.117em;"></span></span></span><span style="position: relative; 
margin-left: -2.78em; top: -0.22em;"><span class="blank" 
style="border-left: 2.78em solid; height: 1.5px; vertical-align: 
0.112em;"></span></span><span class="spacer" style="margin-left: 
0.12em;"></span></span><span style="position: relative; top: -1.385em;"><img
 src="color_metric_files/char13.png" style="height: 35px; width: 8px; 
vertical-align: -34px; margin-right: 0.16em;"></span></span><span 
style="position: relative; margin-left: 0.222em;"><img 
src="color_metric_files/char02.png" style="height: 7px; width: 9px; 
margin-right: 0.13em;"></span><span style="position: relative; 
margin-left: 0.222em;"><img src="color_metric_files/char01.png" 
style="height: 11px; width: 11px; margin-right: 0.041em;"></span><span 
class="icmmi10">B</span><span class="spacer" style="margin-left: 
0.05em;"></span><span style="position: relative; top: -0.288em;"><span 
class="size2"><span class="icmr10">2</span></span><span class="spacer" 
style="margin-left: 0.05em;"></span></span></span></span>&nbsp;</span><span
 class="spacer" style="margin-left: 0.166em;"></span>&nbsp;</span><span 
class="blank" style="width: 26.761em; height: 11.902em; vertical-align: 
6.201em;"></span></span><span class="blank" style="height: 12.002em; 
vertical-align: 6.251em;"></span></span></nobr></div>
<p>This formula has results that are very close to L<sup>*</sup>u<sup>*</sup>v<sup>*</sup>
(with the modified lightness curve) and, more importantly, it is a more <i>stable</i>
algorithm: it does not have a range of colours where it suddenly gives 
far from
optimal results. The weights of the formula could be optimized further, 
but again,
the selection of the closest colour is subjective. My goal was to find a
 reasonable
compromise.
</p><div class="codeCaption">A C code snippet for the colour distance 
function</div>
<div class="codeBlock"><pre>typedef struct {
   unsigned char r, g, b;
} RGB;

double ColourDistance(RGB e1, RGB e2)
{
  long rmean = ( (long)e1.r + (long)e2.r ) / 2;
  long r = (long)e1.r - (long)e2.r;
  long g = (long)e1.g - (long)e2.g;
  long b = (long)e1.b - (long)e2.b;
  return sqrt((((512+rmean)*r*r)&gt;&gt;8) + 4*g*g + (((767-rmean)*b*b)&gt;&gt;8));
}</pre></div> 
<a name="GAMMA"></a>
<h2>Gamma correction</h2>
<p>You may have noticed that the above paragraphs mention both RGB and
<i>non</i>-<i>linear</i> R'G'B' colour spaces. The linear and non-linear
 RGB
spaces are related through gamma-correction. The area of gamma 
correction is
confusing, because the same term is used to describe several entirely
different (but related) phenomena:
</p><ul>
<li>Within a certain range, the non-linearity of the human eye matches a
 power
function. The <span class="typeset"><nobr><span class="scale"><span 
class="icmr10">1</span><img src="color_metric_files/char3D.png" 
style="height: 15px; width: 7px; vertical-align: -4px;"><img 
src="color_metric_files/char0D.png" style="height: 11px; width: 8px; 
vertical-align: -4px; margin-right: -0.057em;"><span class="spacer" 
style="margin-left: 0.055em;"></span></span></nobr></span> fraction 
represents this
power function, and its value is somewhere between 1/2 and 1/3 (the 
value
depends, amongst others, on the viewing conditions--surround light, for
example). As a compromise, much literature nowadays assumes a value
between 1/2.2 and 1/2.5.
</li><li>The non-linearity between the voltage applied to a grid of a 
CRT and the
resulting lightness of the phosphor is a power function whose value is 
close
to 2.5. Incidentally, the non-linearity of CRT displays is a function of
 the
electrostatics of the cathode and the grid of an electronic gun. The
phosphors themselves are quite linear, at least until an intensity of
about 75% where saturation starts to set in. The recurring theme in 
talks
and newsgroups that computer displays vary widely in gamma is almost 
always
due to bad adjustment of the monitor (the "black-level" error) and
the display's reflection of ambient light.
</li><li>Video (television) and computer imaging copied the 
non-linearity, and the
gamma symbol, from photography. The camera film is not linear, but it 
can be
approximated (within a certain range) with a power function.
</li></ul>
<p>Common computer displays have a non-linear relation between the light
intensity (<i>I</i>) output by a phosphor and the voltage (<i>V</i>) 
that is
applied to the grid of the CRT. The non-linearity of a CRT is usually 
defined
as:
</p><div class="typeset"><nobr><span class="scale"><span 
style="position: relative;"><span style="position: absolute; top: 0em; 
left: 0em;"><span class="icmmi10">I</span><span class="spacer" 
style="margin-left: 0.078em;"></span><span style="position: relative; 
margin-left: 0.277em;"><span class="icmr10">=</span></span><span 
style="position: relative; margin-left: 0.277em;"><span class="icmmi10">k</span><span
 class="spacer" style="margin-left: 0.031em;"></span></span><span 
style="position: relative; margin-left: 0.222em;"><img 
src="color_metric_files/char02.png" style="height: 7px; width: 9px; 
margin-right: 0.13em;"></span><span style="position: relative; 
margin-left: 0.222em;"><span class="icmmi10">V</span><span 
class="spacer" style="margin-left: 0.222em;"></span><span 
style="position: relative; top: -0.412em;"><span class="size2"><img 
src="color_metric_files/char0D_002.png" style="height: 8px; width: 6px; 
vertical-align: -3px; margin-right: -0.1em;"></span><span class="spacer"
 style="margin-left: 0.05em;"></span></span></span>&nbsp;</span><span 
class="blank" style="width: 4.508em; height: 1.052em; vertical-align: 
1.052em;"></span></span><span class="blank" style="height: 0.936em; 
vertical-align: 0.803em;"></span></span></nobr></div>
<p>for constants <i>k</i> and <span class="typeset"><nobr><span 
class="scale"><img src="color_metric_files/char0D.png" style="height: 
11px; width: 8px; vertical-align: -4px; margin-right: -0.057em;"><span 
class="spacer" style="margin-left: 0.055em;"></span></span></nobr></span>.
 The value of
<span class="typeset"><nobr><span class="scale"><img 
src="color_metric_files/char0D.png" style="height: 11px; width: 8px; 
vertical-align: -4px; margin-right: -0.057em;"><span class="spacer" 
style="margin-left: 0.055em;"></span></span></nobr></span> is 
approximately 2.5 for all CRT displays;
<i>k</i> may be assumed 1.0 for purpose of illustration. Note that this
formula does not take the black-level error into account. When black 
becomes
dark gray (the essence of the black-level error), the perceived error in
 gamma
changes dramatically. Since computer monitors are often badly adjusted, a
better approximation of the gamma correction formula would be to fix the
 gamma
at 2.5 and to make the black-level error explicit:
</p><div class="typeset"><nobr><span class="scale"><span class="icmmi10">I</span><span
 class="spacer" style="margin-left: 0.078em;"></span><span 
style="position: relative; margin-left: 0.277em;"><span class="icmr10">=</span></span><span
 style="position: relative; margin-left: 0.277em;"><span class="icmmi10">k</span><span
 class="spacer" style="margin-left: 0.031em;"></span></span><span 
style="position: relative; margin-left: 0.222em;"><img 
src="color_metric_files/char02.png" style="height: 7px; width: 9px; 
margin-right: 0.13em;"></span><span style="position: relative; 
margin-left: 0.222em;"><span class="icmr10">(</span></span><span 
class="icmmi10">V</span><span class="spacer" style="margin-left: 
0.222em;"></span><span style="position: relative; margin-left: 0.222em;"><span
 class="icmr10">+</span></span><span style="position: relative; 
margin-left: 0.222em;"><img src="color_metric_files/char22.png" 
style="height: 8px; width: 6px; vertical-align: -1px; margin-right: 
0.034em;"></span><span class="icmr10">)</span><span style="position: 
relative; top: -0.412em;"><span class="size2"><span class="icmr10">2</span><img
 src="color_metric_files/char3A_002.png" style="height: 2px; width: 2px;
 margin-right: 0.071em;"><span class="icmr10">5</span></span><span 
class="spacer" style="margin-left: 0.05em;"></span></span></span></nobr></div>
<p>To put these formulae into a more "visual" perspective: when a
typical computer monitor has "contrast" and "brightness"
knobs, the "contrast" knob sets the <i>k</i> variable and the
"brightness" setting adjusts the <span class="typeset"><nobr><span 
class="scale"><img src="color_metric_files/char22.png" style="height: 
8px; width: 6px; vertical-align: -1px; margin-right: 0.034em;"></span></nobr></span>
 variable.
</p><p>The transformation of the linear RGB colour space to the 
non-linear R'G'B'
space is known as gamma correction. The red, green and blue channels of a
colour each go through the formula:
</p><div class="typeset"><nobr><span class="scale"><span 
style="position: relative;"><span style="position: absolute; top: 0em; 
left: 0em;"><span class="icmmi10">S</span><span class="spacer" 
style="margin-left: 0.057em;"></span><span style="position: relative; 
top: -0.412em;"><span class="size2"><img 
src="color_metric_files/char30.png" style="height: 6px; width: 3px; 
margin-right: -0.034em;"></span><span class="spacer" style="margin-left:
 0.05em;"></span></span><span style="position: relative; margin-left: 
0.277em;"><span class="icmr10">=</span></span><span style="position: 
relative; margin-left: 0.277em;"><span class="icmmi10">S</span><span 
class="spacer" style="margin-left: 0.057em;"></span><span 
style="position: relative; top: -0.412em;"><span class="size2"><span 
class="icmr10">1</span><img src="color_metric_files/char3D_002.png" 
style="height: 11px; width: 5px; vertical-align: -3px; margin-right: 
-0.015em;"></span><span class="size2"><img 
src="color_metric_files/char0D_002.png" style="height: 8px; width: 6px; 
vertical-align: -3px; margin-right: -0.1em;"></span><span class="spacer"
 style="margin-left: 0.038em;"></span><span class="spacer" 
style="margin-left: 0.05em;"></span></span></span>&nbsp;</span><span 
class="blank" style="width: 3.682em; height: 1.052em; vertical-align: 
1.052em;"></span></span><span class="blank" style="height: 1.072em; 
vertical-align: 1.022em;"></span></span></nobr></div>
<p>where <i>S</i> is the source signal (colour component) and <i>S'</i> 
is the
corrected source; both <i>S</i> and <i>S'</i> are in the range 0.0--1.0.
</p><p>In practice, the palettes of 256-colour images that are to be 
displayed on
a computer monitor have already been "corrected" for this
non-linearity so that the image shows the correct colours without 
further
processing.
</p><p>See <a href="#POYNTON1">Charles Poynton's FAQ</a> and article for
 more
fascinating reading on these topics, as well as the "proper"
formula (standardized for video and HDTV) of gamma correction. When your
pictures or screen lay-outs must look <i>right</i> on a typical computer
display in a typical office however, you need to "tweak" and tune the
brightness levels, rather than rigidly applying formulae: the 
black-level
error and the reflection of ambient light make the issue of gamma 
correction
on computer displays quite senseless.
</p><h2>References</h2>
<dir>
<a name="ALMAN"></a>
<p>Alman, D.H.; "Industrial color difference evaluation"; Color Research
 and Application;
No. 18 (1993); pp. 137-139
<a name="FOLEY"></a>
</p><p>Foley, J.D., A. van Dam, S.K. Feiner, J.F. Hughes;
"Computer Graphics, Principles and Practice"; second edition;
Addison-Wesley; 1990; pp. 574-600.<br>
<i>An overview of many colour models, with the focus on how they
relate to each other and to the CIE XYZ model. On page 589, the book
says: "The Y component of YIQ [...] is defined to be the same as
the CIE Y primary". As the CIE Y (luminance) is linear, this implies
that the Y channel of YIQ (video luma) is linear as well. This is
explicitly contradicted by <a href="#POYNTON2">Poynton's colorspace-faq</a>,
item 10.</i>
<a name="GRANGER"></a>
</p><p>Granger, E.M.; "Is CIE L*a*b* Good Enough for Desktop 
Publishing?";
technical report, Light Source Inc.; 1994.<br>
<i>Granger claims that CIE L*a*b* has flaws. The Guth ADT colour space
is proposed as an alternative.</i>
<a name="NEMCSICS"></a>
</p><p>Nemcsics, A.; "Color Dynamics"; Publisher Akadmiai Kiad, 
Budapest; 1993.
<a name="POYNTON1"></a>
</p><p>Poynton, Charles A.; "Gamma and its Disguises"; Journal
of the Society of Motion Picture and Television Engineers; Vol. 102,
No. 12 (December 1993); pp. 1099-1108.
<a name="POYNTON2"></a>
</p><p><a href="http://www.poynton.com/">Poynton, Charles A.;
"Frequently Asked Questions About Colour"</a> ("colorspace-faq"); 1999.<br>
<i>"Frequently Asked Questions About Colour". Maintained
and available on the Internet in text (ASCII), Postscript and Adobe
Acrobat formats.</i>
</p></dir>
<script>
jsMath.Process(document);
</script>
</div> <div id="footer"> <div class="left"> Copyright © 2009, Thiadmer 
Riemersma, <a href="http://www.compuphase.com/">ITB CompuPhase</a><br>Updated:
 2009-09-28 </div> <br class="doNotDisplay doNotPrint"> <div 
class="right"> <a rel="license" 
href="http://creativecommons.org/licenses/by-sa/3.0/"><img alt="Creative
 Commons License" src="color_metric_files/somerights20.png" 
align="right" border="0"></a> <small>This work is licensed under a 
&nbsp; <br> <a rel="license" 
href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons 
License</a> &nbsp;</small> </div> </div> </body></html>